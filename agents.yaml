import yaml

from mediation_core.models import AI, AIEMediator

def load_agents_from_yaml(file_path):
    with open(file_path, "r", encoding="utf-8") as f:
        data = yaml.safe_load(f)
    agents = []
    for ag in data["agents"]:
        agents.append(
            AI(
                id=ag["id"],
                proposal=ag["proposal"],
                risk_evaluation=ag["risk_evaluation"],
                priority_values=ag["priority_values"],
                relativity_level=ag["relativity_level"],
            )
        )
    max_rounds = data.get("mediation_parameters", {}).get("max_rounds", 5)
    harmony_threshold = data.get("mediation_parameters", {}).get("harmony_threshold", 0.3)
    return agents, max_rounds, harmony_threshold

if __name__ == "__main__":
    agents, max_rounds, harmony_threshold = load_agents_from_yaml("agents.yaml")
    mediator = AIEMediator(
        agents,
        max_rounds=max_rounds,
        harmony_threshold=harmony_threshold,
    )
    mediator.mediate()
